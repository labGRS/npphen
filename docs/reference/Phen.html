<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Phen — Phen • npphen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phen — Phen"><meta name="description" content="Estimates the annual phenological cycle from a time series of vegetation greenness."><meta property="og:description" content="Estimates the annual phenological cycle from a time series of vegetation greenness."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">npphen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/labGRS/npphen/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Phen</h1>
      <small class="dont-index">Source: <a href="https://github.com/labGRS/npphen/blob/HEAD/R/Phen.R" class="external-link"><code>R/Phen.R</code></a></small>
      <div class="d-none name"><code>Phen.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the annual phenological cycle from a time series of vegetation greenness.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Phen</span><span class="op">(</span><span class="va">x</span>, <span class="va">dates</span>, <span class="va">h</span>, frequency <span class="op">=</span> <span class="st">"16-days"</span>, <span class="va">rge</span>, plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric vector. A time series of a vegetation index (e.g. LAI, NDVI, EVI) or any other variable with seasonal behavior. The code has been optimized to work with integer values. Please re-scale the input values if necessary (e.g. NDVI ranging from 0.0000 to 1.0000, multiply by 10,000).</p></dd>


<dt id="arg-dates">dates<a class="anchor" aria-label="anchor" href="#arg-dates"></a></dt>
<dd><p>A date vector. The number of dates must be equal to the number of "x" values (numeric input vector).</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>Numeric. Indicates the geographic hemisphere to define the starting date of the growing season. h = 1 if the vegetation is in the Northern Hemisphere (season starting at January 1st), h = 2 if it is in the Southern Hemisphere (season starting at July 1st)</p></dd>


<dt id="arg-frequency">frequency<a class="anchor" aria-label="anchor" href="#arg-frequency"></a></dt>
<dd><p>Character string. Defines the number of samples for the output phenology and must be one of the following options: 'daily' giving output vector of length 365, '8-days' giving output vector of length 46 (i.e MOD13Q1 and MYD13Q1), 'monthly' giving output vector of length 12,'bi-weekly' giving output vector of length 24 (i.e. GIMMS) or '16-days' (default) giving output vector of length 23 (i.e MOD13Q1 or MYD13Q1).</p></dd>


<dt id="arg-rge">rge<a class="anchor" aria-label="anchor" href="#arg-rge"></a></dt>
<dd><p>Numeric vector with two values setting the minimum and maximum values of the response variable (e.g. NDVI) used in the analysis. We suggest the use of theoretically based limits. For example in the case of MODIS NDVI or EVI, it ranges from 0 to 10,000, so rge = c(0,10000)</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical. Set TRUE (default) or FALSE to show the phenology curve plot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric vector, where each value represents the expected greeness at that date</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Derives the annual phenological cycle for a standard growing season using a numeric vector of vegetation canopy greenness values (e.g. Leaf Area Index, LAI) or satellite based greenness proxies such as the Normalized Difference Vegetation Index (NDVI) or Enhanced Vegetation Index (EVI). A vector with dates for the greenness values is also required.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PhenMap.html">PhenMap</a></code>,<code><a href="PhenKplot.html">PhenKplot</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-plt img"><img src="Phen-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Testing raster data from Central Chile (NDVI), h=2##</span></span></span>
<span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/MegaDrought_spatRast.rda"</span>, package <span class="op">=</span> <span class="st">"npphen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MegaDrought</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/serialize.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Dates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"modis_dates"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a Raster time series using a raster stack and a date database from Central Chile</span></span></span>
<span class="r-in"><span><span class="co"># Obtain data from a particular pixel generating a time series</span></span></span>
<span class="r-in"><span><span class="va">md_pixel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">MegaDrought</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">313395</span>, <span class="fl">6356610</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">md_pixelts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">MegaDrought</span><span class="op">[</span><span class="va">md_pixel</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modis_dates</span>, <span class="va">md_pixelts</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Phen-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Phenology for the given pixel</span></span></span>
<span class="r-in"><span><span class="fu">Phen</span><span class="op">(</span>x <span class="op">=</span> <span class="va">md_pixelts</span>, dates <span class="op">=</span> <span class="va">modis_dates</span>, h <span class="op">=</span> <span class="fl">2</span>, frequency <span class="op">=</span> <span class="st">"16-days"</span>, rge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Phen-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1       17       33       49       65       81       97      113 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA 5791.583 5871.743 5831.663 5811.623 5911.824 5851.703 4789.579 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      129      145      161      177      193      209      225      241 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4549.098 4088.176 3907.816 3667.335 3486.974 3426.854 3426.854 3446.894 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      257      273      289      305      321      337      353 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3466.934 3466.934 3507.014 3567.134 3667.335 3767.535 4488.978 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Testing with the Bdesert_stack from the Atacama Desert, Northern Chile (NDVI), h=2 ##</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="co"># SparRaster</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Bdesert_spatRast.rda"</span>, package <span class="op">=</span> <span class="st">"npphen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bdesert</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/serialize.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a Raster time series using a raster stack and a date database from Northern Chile</span></span></span>
<span class="r-in"><span><span class="co"># Obtain data from a particular pixel generating a time series</span></span></span>
<span class="r-in"><span><span class="va">bd_pixel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">Bdesert</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">286638</span>, <span class="fl">6852107</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bd_pixelts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Bdesert</span><span class="op">[</span><span class="va">bd_pixel</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modis_dates</span>, <span class="va">bd_pixelts</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Phen-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Phenology for the given pixel</span></span></span>
<span class="r-in"><span><span class="fu">Phen</span><span class="op">(</span>x <span class="op">=</span> <span class="va">bd_pixelts</span>, dates <span class="op">=</span> <span class="va">modis_dates</span>, h <span class="op">=</span> <span class="fl">2</span>, frequency <span class="op">=</span> <span class="st">"16-days"</span>, rge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Phen-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1       17       33       49       65       81       97      113 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA 721.4429 721.4429 721.4429 701.4028 701.4028 681.3627 681.3627 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      129      145      161      177      193      209      225      241 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 681.3627 661.3226 661.3226 661.3226 641.2826 641.2826 661.3226 661.3226 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      257      273      289      305      321      337      353 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 661.3226 661.3226 681.3627 681.3627 681.3627 701.4028 701.4028 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roberto O. Chávez, Sergio A. Estay, José A. Lastra.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

