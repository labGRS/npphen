[{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"José . Lastra. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chávez, R.O., Estay, S.., Lastra, J.., Riquelme, C.G. (2023). npphen: R-package Vegetation Phenological Cycle Anomaly Detection using Remote Sensing Data. PUCV, AUCH,  Chile.","code":"@Manual{,   title = {{npphen}: an R-package for Vegetation Phenological Cycle and Anomaly Detection using Remote         Sensing Data},   author = {Roberto O. Chávez and Sergio A. Estay and José A. Lastra and Carlos G. Riquelme},   address = {Chile},   year = {2023},   url = {https://CRAN.R-project.org/package=npphen}, }"},{"path":"/index.html","id":"npphen-","dir":"","previous_headings":"","what":"Vegetation Phenological Cycle and Anomaly Detection using Remote\n        Sensing Data","title":"Vegetation Phenological Cycle and Anomaly Detection using Remote\n        Sensing Data","text":"R package npphen developed primarily enable land surface phenology reconstruction anomaly detection using remote sensing time series. Nevertheless, npphen includes functions analyze type numerical time series. Examples remote sensing time series can tackled using npphen NDVI (Normalized Difference Vegetation Index) time series GIMMS project, U.S. MODIS Program E.S.. Sentinel 2 Program. Examples numerical time series can NPP (Net Primary Productivity) FluxNet Tower.","code":""},{"path":"/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Vegetation Phenological Cycle and Anomaly Detection using Remote\n        Sensing Data","text":"Simple phenology Phenology confidence intervals Custom anomaly calculation using long term phenology baseline Raster functions raster time series","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Vegetation Phenological Cycle and Anomaly Detection using Remote\n        Sensing Data","text":"install stable version CRAN: developers version: brief introduction examples, check tutorial. See changelogs NEWS.md","code":"install.packages(\"npphen\") library(npphen) remotes::install_github('labGRS/npphen') library(npphen)"},{"path":"/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Vegetation Phenological Cycle and Anomaly Detection using Remote\n        Sensing Data","text":"npphen package whole licensed GPLv3. See LICENSE file details.","code":""},{"path":"/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Vegetation Phenological Cycle and Anomaly Detection using Remote\n        Sensing Data","text":"See recently published paper applications examples use npphen: Chávez, R.O.; Estay, S..; Lastra, J..; Riquelme, C.G.; Olea, M.; Aguayo, J.; Decuyper, M. npphen: R-Package Detecting Mapping Extreme Vegetation Anomalies Based Remotely Sensed Phenological Variability. Remote Sens. 2023, 15, 73. https://doi.org/10.3390/rs15010073","code":""},{"path":"/reference/Bdesert_stack.html","id":null,"dir":"Reference","previous_headings":"","what":"Blooming Desert Northern Chile — Bdesert_stack","title":"Blooming Desert Northern Chile — Bdesert_stack","text":"MODIS NDVI RasterStack Atacama Desert, Northern Chile, combining MOD13Q1 & MYD13Q1 2000.02.18 2021.06.26, cleaned using detailed QA band. Blooming deserts rare greening events seen positive NDVI anomalies Atacama","code":""},{"path":"/reference/Bdesert_stack.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Blooming Desert Northern Chile — Bdesert_stack","text":"","code":"Bdesert_stack"},{"path":"/reference/Bdesert_stack.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Blooming Desert Northern Chile — Bdesert_stack","text":"RasterStack EPSG:32719","code":""},{"path":"/reference/Bdesert_stack.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Blooming Desert Northern Chile — Bdesert_stack","text":"https://lpdaac.usgs.gov/","code":""},{"path":"/reference/ExtremeAnom.html","id":null,"dir":"Reference","previous_headings":"","what":"ExtremeAnom — ExtremeAnom","title":"ExtremeAnom — ExtremeAnom","text":"Based annual reference frequency distribution (rfd) vegetation index time series (e.g. numeric vector NDVI), calculates anomalies extreme anomalies (rfd position ranging 0 100)","code":""},{"path":"/reference/ExtremeAnom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ExtremeAnom — ExtremeAnom","text":"","code":"ExtremeAnom(x, dates, h, refp, anop, rge, output = \"both\", rfd = 0.9)"},{"path":"/reference/ExtremeAnom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ExtremeAnom — ExtremeAnom","text":"x Numeric vector. time series vegetation index (e.g. LAI, NDVI, EVI) variable seasonal behavior. code optimized work integer values. Please re-scale input values necessary (e.g. NDVI ranging 0.0000 1.0000, multiply 10,000 dates date vector. number dates must equal number \"x\" values (numeric input vector). h Numeric. Indicates geographic hemisphere. argument defines starting date growing season. h = 1 Northern Hemisphere (season starting January 1st), h = 2 Southern Hemisphere (season starting July 1st). refp Numeric vector correlative number dates used reference period. example, refp = c(1:388) MODIS Vegetation Index 16-days composites MOD13Q1 (18/02/2000 – 18/12/2016) anop Numeric vector correlative number dates period anomalies rfd position (extreme anomalies ) calculated. example anop = c(389:411) complete 2017 MODIS Vegetation Index 16-days composites MOD13Q1 (01/01/2017 – 19/12/2017). anop y refp can overlapped. rge Numeric vector two values setting minimum maximum values response variable (e.g. NDVI) used analysis. suggest use theoretically based limits. example case MODIS NDVI EVI, ranges 0 10,000, rge = c(0,10000) output Character string. Defines output values. '' (default) returns anomalies rfd position together single numeric vector, 'anomalies' returns anomalies, 'rfd' returns rfd values (extreme anomalies ) 'clean' returns extreme anomalies, .e. anomalies given rfd overpass (e.g. 0.90). critical threshold set users using rfd argument. rfd Numeric. argument applies argument output = 'clean'. defines percentile (0 0.99) reference frequency distribution, anomalies flagged extreme anomalies. example, 'rfd = 0.90' anomalies falling outside '0.90 rfd' (default value) flagged extreme anomalies rest neglected (NA values). Please notice 'rfd = 0.90' implies 5% extreme positive 5% extreme negative anomalies considered.","code":""},{"path":"/reference/ExtremeAnom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ExtremeAnom — ExtremeAnom","text":"numerical vector","code":""},{"path":"/reference/ExtremeAnom.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ExtremeAnom — ExtremeAnom","text":"Calculates anomalies probabilistic measure extreme anomalies using numeric vector vegetation canopy greenness, e.g. satellite based Normalized Difference Vegetation Index (NDVI) Enhanced Vegetation Index (EVI). purpose, divides time series (numeric vector) vegetation greenness 2: reference period, annual phenological reference calculated (Phen function), observation period, want calculate anomalies. anomalies can filtered position observation within historical rfd. Users can, example, set 'rfd = 0.95' consider anomalies outside 95% rfd historical records.","code":""},{"path":[]},{"path":"/reference/ExtremeAnom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ExtremeAnom — ExtremeAnom","text":"","code":"# \\dontshow{ ## Testing the function with NDVI time series of deciduous N. macrocarpa forest in Central Chile # Load data data(\"phents\")  all.dates <- as.Date(phents$dates)  # Reference period: 2000 - 2010 (1:423), anomaly detection period: 2010 onwards (424:929) anom_rfd <- ExtremeAnom(   x = phents$NDVI, dates = all.dates, h = 2, refp = c(1:423),   anop = c(1:929), rge = c(0, 10000), output = \"both\", rfd = 0.90 )  selection <- which(anom_rfd[930:1858] > 90)  # basic plot barplot(names = format.Date(all.dates[selection], format = \"%Y-%m\"), anom_rfd[selection], col = ifelse(anom_rfd[selection] < 0, \"red\", \"blue\"), main = \"Anomalies whit rfd > 95%\") abline(h = 0) # }  # \\donttest{ library(lubridate) #>  #> Attaching package: 'lubridate' #> The following objects are masked from 'package:raster': #>  #>     intersect, union #> The following objects are masked from 'package:base': #>  #>     date, intersect, setdiff, union library(terra) #> terra 1.7.39 #>  #> Attaching package: 'terra' #> The following object is masked from 'package:ks': #>  #>     compare ## Testing raster data from Central Chile (NDVI), h=2## # Load data f <- system.file(\"extdata/MegaDrought_spatRast.rda\", package = \"npphen\") MegaDrought <- readRDS(f) #> Warning: cannot open compressed file '', probable reason 'Invalid argument' #> Error in gzfile(file, \"rb\"): cannot open the connection # Dates data(\"modis_dates\")  # Generate a Raster time series using a raster stack and a date database from Central Chile # Obtain data from a particular pixel generating a time series md_pixel <- cellFromXY(MegaDrought, cbind(313395, 6356610)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'cellFromXY': object 'MegaDrought' not found md_pixelts <- as.numeric(MegaDrought[md_pixel]) #> Error in eval(expr, envir, enclos): object 'MegaDrought' not found plot(modis_dates, md_pixelts, type = \"l\") #> Error in h(simpleError(msg, call)): error in evaluating the argument 'y' in selecting a method for function 'plot': object 'md_pixelts' not found  # Anomaly detection for the given pixel anomRFD_MD <- ExtremeAnom(   x = md_pixelts, dates = modis_dates,   h = 2, refp = c(1:423), anop = c(884:929), rfd = 0.9, output = \"both\", rge = c(0, 10000) ) #> Error in eval(expr, envir, enclos): object 'md_pixelts' not found  # Basic plot  selection <- which(anomRFD_MD[47:92] > 90) #> Error in eval(expr, envir, enclos): object 'anomRFD_MD' not found  barplot(   names = format.Date(modis_dates[884:929], format = \"%Y-%m\"),   anomRFD_MD[1:46], col = ifelse(anomRFD_MD[1:46] < 0, \"red\", \"blue\"),   main = \"Anomalies whit rfd > 0.90\" ) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'height' in selecting a method for function 'barplot': object 'anomRFD_MD' not found abline(h = 0)  ## Testing with the Bdesert_stack from the Atacama Desert, Northern Chile (NDVI), # showing extreme positive anomalies (greening)##  # Load data # SparRaster f <- system.file(\"extdata/Bdesert_spatRast.rda\", package = \"npphen\") Bdesert <- readRDS(f) #> Warning: cannot open compressed file '', probable reason 'Invalid argument' #> Error in gzfile(file, \"rb\"): cannot open the connection  # Generate a Raster time series using a raster stack and a date database from Northern Chile # Obtain data from a particular pixel generating a time series bd_pixel <- cellFromXY(Bdesert, cbind(286638, 6852107)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'cellFromXY': object 'Bdesert' not found bd_pixelts <- as.numeric(Bdesert[bd_pixel]) #> Error in eval(expr, envir, enclos): object 'Bdesert' not found plot(modis_dates, bd_pixelts, type = \"l\") #> Error in h(simpleError(msg, call)): error in evaluating the argument 'y' in selecting a method for function 'plot': object 'bd_pixelts' not found  # Anomaly detection for the given pixel anomRFD_BD <- ExtremeAnom(   x = bd_pixelts, dates = modis_dates,   h = 2, refp = c(1:423), anop = c(723:768), rfd = 0.9, output = \"both\", rge = c(0, 10000) ) #> Error in eval(expr, envir, enclos): object 'bd_pixelts' not found  # Basic plot  selection <- which(anomRFD_BD[47:92] > 95) #> Error in eval(expr, envir, enclos): object 'anomRFD_BD' not found  # basic plot barplot(   names = format.Date(modis_dates[723:768], format = \"%Y-%m\"),   anomRFD_BD[1:46], col = ifelse(anomRFD_BD[1:46] < 0, \"red\", \"blue\"),   main = \"Anomalies whit rfd > 0.95\" ) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'height' in selecting a method for function 'barplot': object 'anomRFD_BD' not found abline(h = 0)  # }"},{"path":"/reference/ExtremeAnoMap.html","id":null,"dir":"Reference","previous_headings":"","what":"ExtremeAnoMap — ExtremeAnoMap","title":"ExtremeAnoMap — ExtremeAnoMap","text":"Based annual reference frequency distribution (RFD) vegetation index time series (e.g. raster stack NDVI), calculates anomalies extreme anomalies (RFD position ranging 0 100).","code":""},{"path":"/reference/ExtremeAnoMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ExtremeAnoMap — ExtremeAnoMap","text":"","code":"ExtremeAnoMap(s, dates, h, refp, anop, rge, output = \"both\", rfd = 0.9,   nCluster, outname, datatype)"},{"path":"/reference/ExtremeAnoMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ExtremeAnoMap — ExtremeAnoMap","text":"s SpatRaster. time series vegetation index (e.g. LAI, NDVI, EVI) variable seasonal behavior.code optimized work integer values. Please re-scale input SpatRaster necessary (e.g. NDVI ranging 0.0000 1.0000, multiply 10,000). dates date vector. number dates must equal number layers vegetation index SpatRaster. h Numeric. Indicates geographic hemisphere define starting date growing season. h = 1 vegetation Northern Hemisphere (season starting January 1st), h = 2 Southern Hemisphere (season starting July 1st). refp Numeric vector correlative number dates used reference period. example, refp = c(1:393) MODIS Vegetation Index 16-days composites (18/02/2000 – 06/06/2017) anop Numeric vector correlative number dates period anomalies calculated. example refp = c(21:43) first complete year MODIS Vegetation Index 16-days composites (01/01/2001 – 19/12/2001). anop y refp can overlap rge Numeric vector minimum maximum values vegetation index used analysis. suggest use theoretically based limits. example case MODIS NDVI EVI, ranges 0 10,000, rge = c(0,10000). output Character string. Defines outputs. output = '' (default) returns vegetation index anomalies rfd position together single numeric vector, output = 'anomalies' returns anomalies, output = 'rfd' returns rfd values (extreme anomalies ) output = 'clean' returns anomalies given rfd overpass (e.g. 0.90). critical threshold set users using rfd argument. rfd Numeric. argument applies argument output = 'clean'. defines percentile (0 0.99) reference frequency distribution, anomalies flagged extreme anomalies. example, 'rfd = 0.90' anomalies falling outside '0.90 rfd' (default value) flagged extreme anomalies rest neglected (NA values). Please notice 'rfd = 0.90' implies 5% extreme positive 5% extreme negative anomalies considered. nCluster Numeric. Number CPU cores used computational calculations outname Character vector output directory path filename extension filename extension working directory set. example outname = \"output_anom.tif\". See writeRaster datatype Character. Output data type. example datatype = \"INT2S\" signed integer values. See writeRaster","code":""},{"path":"/reference/ExtremeAnoMap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ExtremeAnoMap — ExtremeAnoMap","text":"SpatRaster","code":""},{"path":"/reference/ExtremeAnoMap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ExtremeAnoMap — ExtremeAnoMap","text":"Similar ExtremeAnom, calculates phenological anomalies using raster stack instead numeric vector vegetation canopy greenness values (e.g. Leaf Area Index, LAI) satellite based greenness proxies Normalized Difference Vegetation Index (NDVI) Enhanced Vegetation Index (EVI). purpose, divides time series (raster stack) vegetation greenness 2: reference period, annual phenological cycle calculated (PhenMap function), observation period, want calculate anomalies respect annual phenological cycle. Negative anomalies correspond observed values lower reference positive anomalies values higher reference. anomalies can filtered position observation within historical rfd. Users can, example, set 'rfd = 0.95' consider anomalies outside 95% rfd historical records.","code":""},{"path":[]},{"path":"/reference/ExtremeAnoMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ExtremeAnoMap — ExtremeAnoMap","text":"","code":"if (FALSE) { ## DEPENDING ON HARDWARE, THIS PROCESS CAN BE HIGHLY TIME CONSUMING##  ## Testing with the MegaDrought_stack from Central Chile (NDVI), # showing extreme negative anomalies (browning)##  # Load data  # SpatRaster library(terra) f <- system.file(\"extdata/MegaDrought_spatRast.rda\", package = \"npphen\") MegaDrought <- readRDS(f) # Dates data(\"modis_dates\")  # Define the number of cores to be use. In this example we use 1 nc1 <- 1 ExtremeAnoMap(   s = MegaDrought, dates = modis_dates, h = 2, refp = c(1:423),   anop = c(884:929), rfd = 0.9, output = \"both\", nCluster = nc1, outname = \"anomRFD_MD.tif\",   datatype = \"INT2S\", rge = c(0, 10000) ) # map_an1 <- rast(\"anomRFD_MD.tif\")#run only for load anomaly brick # plot(map_an1)  ## Testing with the Bdesert_stack from the Atacama Desert, Northern Chile (NDVI), # showing extreme positive anomalies (greening)##  # Load data SpatRaster f <- system.file(\"extdata/Bdesert_spatRast.rda\", package = \"npphen\") Bdesert <- readRDS(f) # Dates data(\"modis_dates\")  # Define the number of cores to be use. In this example we use 1 nc1 <- 1  ExtremeAnoMap(   s = Bdesert, dates = modis_dates, h = 2, refp = c(1:423),   anop = c(723:768), rfd = 0.9, output = \"both\", nCluster = nc1, outname = \"anomRFD_BD.tif\",   datatype = \"INT2S\", rge = c(0, 10000) ) # map_an1 <- rast(\"anomRFD_BD.tif\")#run only for load anomaly brick # plot(map_an1) }"},{"path":"/reference/MegaDrought_stack.html","id":null,"dir":"Reference","previous_headings":"","what":"Mega drought in Central Chile — MegaDrought_stack","title":"Mega drought in Central Chile — MegaDrought_stack","text":"MODIS NDVI RasterStack Central Chile combining MOD13Q1 & MYD13Q1 2000.02.18 2021.06.26,  cleaned using detailed QA band. Megadrought affected Central Chile 2010 2015 2019-2022","code":""},{"path":"/reference/MegaDrought_stack.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mega drought in Central Chile — MegaDrought_stack","text":"","code":"MegaDrought_stack"},{"path":"/reference/MegaDrought_stack.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mega drought in Central Chile — MegaDrought_stack","text":"RasterStack EPSG:32719","code":""},{"path":"/reference/MegaDrought_stack.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mega drought in Central Chile — MegaDrought_stack","text":"https://lpdaac.usgs.gov/","code":""},{"path":"/reference/modis_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"A vector with dates for both RasterStack datasets: Mega drought and Blooming Desert, with 929 dates — modis_dates","title":"A vector with dates for both RasterStack datasets: Mega drought and Blooming Desert, with 929 dates — modis_dates","text":"vector dates RasterStack datasets: Mega drought Blooming Desert, 929 dates","code":""},{"path":"/reference/modis_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A vector with dates for both RasterStack datasets: Mega drought and Blooming Desert, with 929 dates — modis_dates","text":"","code":"modis_dates"},{"path":"/reference/modis_dates.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A vector with dates for both RasterStack datasets: Mega drought and Blooming Desert, with 929 dates — modis_dates","text":"Vector dates","code":""},{"path":"/reference/modis_dates.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A vector with dates for both RasterStack datasets: Mega drought and Blooming Desert, with 929 dates — modis_dates","text":"https://lpdaac.usgs.gov/","code":""},{"path":"/reference/npphen.html","id":null,"dir":"Reference","previous_headings":"","what":"npphen — npphen","title":"npphen — npphen","text":"functions package estimate expected annual phenological cycle time series raster stack vegetation (greenness) indexes. algorithm estimate annual phenological cycle (used functions npphen) uses bivariate kernel density estimator index-time space. space, x-axis corresponds days growing season (1-365) y-axis vegetation index values, range's values set using rge argument (see function's vignette details). expected value index day growing season (expected phenology) approximated maximum value kernel day. Anomalies calculated deviations expected values given days. package implements basic high-level functions manipulating vector data (numerical series) raster data (satellite derived products). Processing large raster files supported. methodological details kernel density estimation see Wand & Jones (1994).","code":""},{"path":"/reference/npphen.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"npphen — npphen","text":"Wand, M.P. & Jones, M.C. (1994) Kernel smoothing. Crc Press.","code":""},{"path":[]},{"path":"/reference/npphen.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"npphen — npphen","text":"Roberto O. Chávez  roberto.chavez.o@pucv.cl  Sergio . Estay  sergio.estay@uach.cl  José . Lastra  jose.lastra@pucv.cl  Carlos G. Riquelme  carlosriquelmemv@gmail.com","code":""},{"path":"/reference/Phen.html","id":null,"dir":"Reference","previous_headings":"","what":"Phen — Phen","title":"Phen — Phen","text":"Estimates annual phenological cycle time series vegetation greenness.","code":""},{"path":"/reference/Phen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phen — Phen","text":"","code":"Phen(x, dates, h, frequency = \"16-days\", rge, plot = T)"},{"path":"/reference/Phen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phen — Phen","text":"x Numeric vector. time series vegetation index (e.g. LAI, NDVI, EVI) variable seasonal behavior. code optimized work integer values. Please re-scale input values necessary (e.g. NDVI ranging 0.0000 1.0000, multiply 10,000 dates date vector. number dates must equal number \"x\" values (numeric input vector). h Numeric. Indicates geographic hemisphere define starting date growing season. h = 1 vegetation Northern Hemisphere (season starting January 1st), h = 2 Southern Hemisphere (season starting July 1st) frequency Character string. Defines number samples output phenology must one following options: 'daily' giving output vector length 365, '8-days' giving output vector length 46 (.e MOD13Q1 MYD13Q1), 'monthly' giving output vector length 12,'bi-weekly' giving output vector length 24 (.e. GIMMS) '16-days' (default) giving output vector length 23 (.e MOD13Q1 MYD13Q1). rge Numeric vector two values setting minimum maximum values response variable (e.g. NDVI) used analysis. suggest use theoretically based limits. example case MODIS NDVI EVI, ranges 0 10,000, rge = c(0,10000) plot Logical. Set TRUE (default) FALSE show phenology curve plot.","code":""},{"path":"/reference/Phen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phen — Phen","text":"numeric vector, value represents expected greeness date","code":""},{"path":"/reference/Phen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Phen — Phen","text":"Derives annual phenological cycle standard growing season using numeric vector vegetation canopy greenness values (e.g. Leaf Area Index, LAI) satellite based greenness proxies Normalized Difference Vegetation Index (NDVI) Enhanced Vegetation Index (EVI). vector dates greenness values also required.","code":""},{"path":[]},{"path":"/reference/Phen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Phen — Phen","text":"","code":"# \\dontshow{ ## Testing function with time series of Nothofagus macrocarpa (NDVI) # Load data data(\"phents\") # Phenology for the given data Phen(x = phents$NDVI, dates = phents$dates, h = 2, frequency = \"16-days\", rge = c(0, 10000))  #>        1       17       33       49       65       81       97      113  #> 4809.619 4729.459 4709.419 4729.459 4709.419 4689.379 7254.509 7274.549  #>      129      145      161      177      193      209      225      241  #> 7274.549 7234.469 7154.309 7054.108 6933.868 6873.747 6833.667 6813.627  #>      257      273      289      305      321      337      353  #> 6793.587 6733.467 5891.784 4729.459 4669.339 4689.379 4729.459  # } # \\donttest{ library(lubridate) library(terra) ## Testing raster data from Central Chile (NDVI), h=2## # Load data f <- system.file(\"extdata/MegaDrought_spatRast.rda\", package = \"npphen\") MegaDrought <- readRDS(f) #> Warning: cannot open compressed file '', probable reason 'Invalid argument' #> Error in gzfile(file, \"rb\"): cannot open the connection # Dates data(\"modis_dates\")  # Generate a Raster time series using a raster stack and a date database from Central Chile # Obtain data from a particular pixel generating a time series md_pixel <- cellFromXY(MegaDrought, cbind(313395, 6356610)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'cellFromXY': object 'MegaDrought' not found md_pixelts <- as.numeric(MegaDrought[md_pixel]) #> Error in eval(expr, envir, enclos): object 'MegaDrought' not found plot(modis_dates, md_pixelts, type = \"l\") #> Error in h(simpleError(msg, call)): error in evaluating the argument 'y' in selecting a method for function 'plot': object 'md_pixelts' not found  # Phenology for the given pixel Phen(x = md_pixelts, dates = modis_dates, h = 2, frequency = \"16-days\", rge = c(0, 10000)) #> Error in eval(expr, envir, enclos): object 'md_pixelts' not found  ## Testing with the Bdesert_stack from the Atacama Desert, Northern Chile (NDVI), h=2 ##  # Load data # SparRaster f <- system.file(\"extdata/Bdesert_spatRast.rda\", package = \"npphen\") Bdesert <- readRDS(f) #> Warning: cannot open compressed file '', probable reason 'Invalid argument' #> Error in gzfile(file, \"rb\"): cannot open the connection  # Generate a Raster time series using a raster stack and a date database from Northern Chile # Obtain data from a particular pixel generating a time series bd_pixel <- cellFromXY(Bdesert, cbind(286638, 6852107)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'cellFromXY': object 'Bdesert' not found bd_pixelts <- as.numeric(Bdesert[bd_pixel]) #> Error in eval(expr, envir, enclos): object 'Bdesert' not found plot(modis_dates, bd_pixelts, type = \"l\") #> Error in h(simpleError(msg, call)): error in evaluating the argument 'y' in selecting a method for function 'plot': object 'bd_pixelts' not found  # Phenology for the given pixel Phen(x = bd_pixelts, dates = modis_dates, h = 2, frequency = \"16-days\", rge = c(0, 10000)) #> Error in eval(expr, envir, enclos): object 'bd_pixelts' not found # }"},{"path":"/reference/PhenKplot.html","id":null,"dir":"Reference","previous_headings":"","what":"PhenKplot — PhenKplot","title":"PhenKplot — PhenKplot","text":"Plot probable vegetation greenness values.","code":""},{"path":"/reference/PhenKplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PhenKplot — PhenKplot","text":"","code":"PhenKplot(x, dates, h, xlab, ylab, rge)"},{"path":"/reference/PhenKplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PhenKplot — PhenKplot","text":"x Numeric vector. time series vegetation index (e.g. LAI, NDVI, EVI) variable seasonal behavior. code optimized work integer values. Please re-scale input values necessary (e.g. NDVI ranging 0.0000 1.0000, multiply 10,000) dates date vector. number dates must equal number \"x\" values (numeric input vector). h Numeric. Indicates geographic hemisphere define starting date growing season. h = 1 vegetation Northern Hemisphere (season starting January 1st), h = 2 Southern Hemisphere (season starting July 1st) xlab Character vector (expression) giving plot title x axis label (e.g. xlab = \"day growing season\") ylab Character vector (expression) giving plot title y axis label (e.g. ylab = \"NDVI\") rge Numeric vector minimum maximum values vegetation index (e.g. NDVI) used analysis. suggest use theoretically based limits. example case MODIS NDVI EVI, ranges 0 10,000, rge = c(0,10000)","code":""},{"path":"/reference/PhenKplot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"PhenKplot — PhenKplot","text":"\"heatmap\" annual phenological variability Phen output. calculates plot likelihood map vegetation-index–time space using numeric vector greenness proxies Normalized Difference Vegetation Index (NDVI) Enhanced Vegetation Index (EVI). Also vector dates vegetation index values required. function partially based ci2d function package gplots.","code":""},{"path":[]},{"path":"/reference/PhenKplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PhenKplot — PhenKplot","text":"","code":"# \\dontshow{ ## Testing the function with an NDVI time series of a deciduous Nothofagus macrocarpa forest # Load data data(\"phents\") # PhenKplot for the given data PhenKplot(   x = phents$NDVI, dates = phents$dates, h = 2,   xlab = \"Day of the growing season\",   ylab = \"NDVI\", rge = c(0, 10000) )  # } # \\donttest{ library(lubridate) library(terra) ## Testing raster data from Central Chile (NDVI), h=2## # Load data f <- system.file(\"extdata/MegaDrought_spatRast.rda\", package = \"npphen\") MegaDrought <- readRDS(f) #> Warning: cannot open compressed file '', probable reason 'Invalid argument' #> Error in gzfile(file, \"rb\"): cannot open the connection # Dates data(\"modis_dates\")  # Generate a Raster time series from a particular pixel  # using a SpatRaster and a date for Central Chile md_pixel <- cellFromXY(MegaDrought, cbind(313395, 6356610)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'cellFromXY': object 'MegaDrought' not found md_pixelts <- as.numeric(MegaDrought[md_pixel]) #> Error in eval(expr, envir, enclos): object 'MegaDrought' not found plot(modis_dates, md_pixelts, type = \"l\") #> Error in h(simpleError(msg, call)): error in evaluating the argument 'y' in selecting a method for function 'plot': object 'md_pixelts' not found  # Variability of the annual phenology for the given pixel PhenKplot(x = md_pixelts, dates = modis_dates, h = 2, xlab = \"DGS\", ylab = \"NDVI\", rge = c(0, 10000)) #> Error in eval(expr, envir, enclos): object 'md_pixelts' not found   ## Testing with the Bdesert_spatRast from  ## the Atacama Desert, Northern Chile (NDVI), h=2 ##  # Load data # SparRaster f <- system.file(\"extdata/Bdesert_spatRast.rda\", package = \"npphen\") Bdesert <- readRDS(f) #> Warning: cannot open compressed file '', probable reason 'Invalid argument' #> Error in gzfile(file, \"rb\"): cannot open the connection  # Generate a Raster time series from a particular pixel  # using a SpatRaster and a date for Northern Chile bd_pixel <- cellFromXY(Bdesert, cbind(286638, 6852107)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'cellFromXY': object 'Bdesert' not found bd_pixelts <- as.numeric(Bdesert[bd_pixel]) #> Error in eval(expr, envir, enclos): object 'Bdesert' not found plot(modis_dates, bd_pixelts, type = \"l\") #> Error in h(simpleError(msg, call)): error in evaluating the argument 'y' in selecting a method for function 'plot': object 'bd_pixelts' not found  # Variability of the annual phenology for the given pixel PhenKplot(x = bd_pixelts, dates = modis_dates,  h = 2, xlab = \"DGS\", ylab = \"NDVI\", rge = c(0, 10000)) #> Error in eval(expr, envir, enclos): object 'bd_pixelts' not found # }"},{"path":"/reference/PhenMap.html","id":null,"dir":"Reference","previous_headings":"","what":"PhenMap — PhenMap","title":"PhenMap — PhenMap","text":"Estimates annual Land Surface Phenology (LSP) using time series vegetation greenness raster stack.","code":""},{"path":"/reference/PhenMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PhenMap — PhenMap","text":"","code":"PhenMap(s, dates, h, frequency = \"16-days\", nCluster, outname, datatype, rge)"},{"path":"/reference/PhenMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PhenMap — PhenMap","text":"s SpatRaster vegetation index (e.g. LAI, NDVI, EVI) variable seasonal behavior. code optimized work integer values. Please re-scale input SpatRaster necessary (e.g. NDVI ranging 0.0000 1.0000, multiply 10,000) dates date vector. number dates must equal number layers vegetation index SpatRaster. h Numeric. Indicates geographic hemisphere define starting date growing season. h = 1 vegetation Northern Hemisphere (season starting January 1st), h = 2 Southern Hemisphere (season starting July 1st) frequency Character string. Defines number samples output phenology must one following options: 'daily' output vector length 365, '8-days' output vector length 46 (e.g. MOD13Q1 MYD13Q1 combined), 'monthly' output vector length 12,'bi-weekly' output vector length 24 (.e. GIMMS) '16-days' (default) output vector length 23 (.e MOD13Q1 MYD13Q1) nCluster Numeric. Number CPU cores used computational calculations outname Character vector output directory path filename extension filename extension working directory set. example outname = \"output_phen.tif\". See writeRaster datatype Character. Output data type. example datatype = \"INT2S\" signed integer values. See writeRaster rge vector containing minimum maximum values vegetation index used analysis. suggest use theoretically based limits. example case MODIS NDVI EVI, ranges 0 10,000, rge = c(0,10000)","code":""},{"path":"/reference/PhenMap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PhenMap — PhenMap","text":"SpatRaster","code":""},{"path":"/reference/PhenMap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"PhenMap — PhenMap","text":"Per pixel, derives recurrent annual Land Surface Phenology (LSP) reference period  using time series satellite based greenness values Normalized Difference Vegetation Index (NDVI) Enhanced Vegetation Index (EVI). annual LSP calculated pixels input SpatRaster way Phen function. output multiband raster every band expected greenness value given time step growing season. example, MODIS Vegetation Index 16-days composites number time steps growing season 23 (frequency = \"16-days\"), therefore, output raster 23 bands. vector dates greenness values also required","code":""},{"path":[]},{"path":"/reference/PhenMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PhenMap — PhenMap","text":"","code":"if (FALSE) { ## DEPENDING ON HARDWARE, THIS PROCESS CAN BE HIGHLY TIME CONSUMING##  ## Testing with an NDVI spatRast from Central Chile, h = 2##  # Load data # SpatRaster library(terra) f <- system.file(\"extdata/MegaDrought_spatRast.rda\", package = \"npphen\") MegaDrought <- readRDS(f) # Dates data(\"modis_dates\")  # Making the LSP output raster, n bands = 23  # Define the number of cores to be use. In this example we use 1 nc1 <- 1  PhenMap(   s = MegaDrought, dates = modis_dates, h = 2,   frequency = \"16-days\", nCluster = nc1, outname = \"phen_MD.tif\",   datatype = \"INT2S\", rge = c(0, 10000) ) # map1 <- rast(\"phen_MD.tif\")#run only for load phenology brick # plot(map1)  ## Testing with an NDVI spatRast from the Atacama Desert, Northern Chile, h=2 ##  # Load data SpatRaster f <- system.file(\"extdata/Bdesert_spatRast.rda\", package = \"npphen\") Bdesert <- readRDS(f) # Dates data(\"modis_dates\")  # Making the LSP output raster, n bands = 23 # Define the number of cores to be use. In this example we use 1 nc1 <- 1  PhenMap(   s = Bdesert, dates = modis_dates, h = 2,   frequency = \"16-days\", nCluster = 1, outname = \"phen_BD.tif\",   datatype = \"INT2S\", rge = c(0, 10000) ) # map2 <- rast(\"phen_BD.tif\") #run only for loading the multiband LSP spatRaster # plot(map2) }"},{"path":"/reference/phents.html","id":null,"dir":"Reference","previous_headings":"","what":"A dataframe with 8-days MODIS NDVI of a pixel with deciduous Nothofagus macrocarpa forest, Central Chile,\r\nusing MOD13Q1/MYD13Q1 combined — phents","title":"A dataframe with 8-days MODIS NDVI of a pixel with deciduous Nothofagus macrocarpa forest, Central Chile,\r\nusing MOD13Q1/MYD13Q1 combined — phents","text":"dataframe 8-days MODIS NDVI pixel deciduous Nothofagus macrocarpa forest, Central Chile, using MOD13Q1/MYD13Q1 combined","code":""},{"path":"/reference/phents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A dataframe with 8-days MODIS NDVI of a pixel with deciduous Nothofagus macrocarpa forest, Central Chile,\r\nusing MOD13Q1/MYD13Q1 combined — phents","text":"","code":"phents"},{"path":"/reference/phents.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A dataframe with 8-days MODIS NDVI of a pixel with deciduous Nothofagus macrocarpa forest, Central Chile,\r\nusing MOD13Q1/MYD13Q1 combined — phents","text":"data frame 929 rows 2 variables: dates dates record NDVI NDVI value pixel deciduous N. macrocarpa forest","code":""},{"path":"/reference/phents.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A dataframe with 8-days MODIS NDVI of a pixel with deciduous Nothofagus macrocarpa forest, Central Chile,\r\nusing MOD13Q1/MYD13Q1 combined — phents","text":"https://lpdaac.usgs.gov/","code":""},{"path":"/news/index.html","id":"npphen-200","dir":"Changelog","previous_headings":"","what":"npphen 2.0.0","title":"npphen 2.0.0","text":"Remove raster & rgdal dependencies Migrate terra raster data processing Fix minor bugs","code":""},{"path":"/news/index.html","id":"npphen-152","dir":"Changelog","previous_headings":"","what":"npphen 1.5.2","title":"npphen 1.5.2","text":"CRAN release: 2022-06-03 Fix minor bugs","code":""},{"path":"/news/index.html","id":"npphen-151","dir":"Changelog","previous_headings":"","what":"npphen 1.5.1","title":"npphen 1.5.1","text":"CRAN release: 2022-06-02 Fix NA problems ExtremeAnom ExtremeAnoMap","code":""},{"path":"/news/index.html","id":"npphen-150","dir":"Changelog","previous_headings":"","what":"npphen 1.5.0","title":"npphen 1.5.0","text":"CRAN release: 2022-05-24 ExtremeAnom: calculates anomalies extreme anomalies (rfd position ranging 0 100) numeric vector. ExtremeAnoMap: calculates anomalies extreme anomalies (rfd position ranging 0 100) raster stack. Fix minor bugs rfd calculations update replace example data package","code":""},{"path":"/news/index.html","id":"npphen-111","dir":"Changelog","previous_headings":"","what":"npphen 1.1.1","title":"npphen 1.1.1","text":"CRAN release: 2021-11-20 Fix warnings notes CRAN","code":""},{"path":"/news/index.html","id":"npphen-11-0","dir":"Changelog","previous_headings":"","what":"npphen 1.1-0","title":"npphen 1.1-0","text":"CRAN release: 2017-08-31 First version package CRAN","code":""}]
